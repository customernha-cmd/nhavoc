<script>
    var dashboardData;
    google.charts.load('current', {'packages':['corechart', 'bar']});
    google.charts.setOnLoadCallback(fetchData);

    function fetchData() {
        // ❗ ใส่ URL ของ Web App ที่คุณ Deploy ที่นี่
        var webAppUrl = 'https://script.google.com/macros/s/AKfycbw38n_qrWF83W7QQsC0saXkmbdkuUSTi6KVESkNqTPUZPHOB2PaoL3r-rtr8CEkNmP0/exec';
        
        // ใช้ Fetch API เพื่อเรียกข้อมูลจาก Web App URL
        fetch(webAppUrl + '?action=getData')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                dashboardData = data;
                document.getElementById('loading-message').style.display = 'none';
                document.querySelector('.dashboard-container').style.display = 'grid';
                updateTimePeriod('all');
            })
            .catch(showError);
    }
    
    // ... โค้ดส่วนที่เหลือยังคงเดิม ...
</script>
